// MACROS → tiles with copy buttons
if (path.startsWith("macros/")) {
  const macros = parseMacros(md);
  if (!macros.length) {
    showError("Loaded the file, but couldn’t find any macros.");
    return;
  }

  grid.innerHTML = "";
  macros.forEach(m => {
    const card = document.createElement("div");
    card.className = "card";

    const h2 = document.createElement("h2");
    h2.textContent = m.title;

    const pre = document.createElement("pre");
    pre.textContent = m.macroText;

    const row = document.createElement("div");
    row.style.display = "flex";
    row.style.justifyContent = "space-between";
    row.style.alignItems = "center";

    const meta = document.createElement("div");
    meta.className = "meta";
    meta.textContent = "Copy grabs this macro only.";

    const btn = document.createElement("button");
    btn.className = "btn";
    btn.textContent = "Copy macro";
    btn.onclick = () => copyText(btn, m.macroText);

    row.append(meta, btn);
    card.append(h2, pre, row);
    grid.append(card);
  });

} 
// PROCESSES → clean readable document
else {
  grid.innerHTML = "";

  const article = document.createElement("article");
  article.style.lineHeight = "1.6";
  article.style.fontSize = "0.9rem";

  // very light markdown rendering
  article.innerHTML = md
    .replace(/^## (.*)$/gm, "<h2>$1</h2>")
    .replace(/^### (.*)$/gm, "<h3>$1</h3>")
    .replace(/^\- (.*)$/gm, "<li>$1</li>")
    .replace(/(<li>.*<\/li>)/gs, "<ul>$1</ul>")
    .replace(/\n\n/g, "<br><br>");

  grid.append(article);
}
